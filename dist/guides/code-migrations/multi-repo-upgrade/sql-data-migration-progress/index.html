<!DOCTYPE html><html lang="en" data-astro-cid-37fxchfa> <head><meta charset="UTF-8"><meta name="description" content="Amp Examples and Guides"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><title>undefined - Guides</title><style>[data-astro-cid-37fxchfa]{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;line-height:1.6;color:#333;background-color:#fff}nav[data-astro-cid-37fxchfa]{background:#f8f9fa;border-bottom:1px solid #e9ecef;padding:1rem 0}.nav-container[data-astro-cid-37fxchfa]{max-width:1200px;margin:0 auto;padding:0 2rem;display:flex;justify-content:space-between;align-items:center}.logo[data-astro-cid-37fxchfa]{font-weight:600;font-size:1.2rem;color:#06c;text-decoration:none}.nav-links[data-astro-cid-37fxchfa]{display:flex;gap:2rem}.nav-links[data-astro-cid-37fxchfa] a[data-astro-cid-37fxchfa]{color:#333;text-decoration:none;font-weight:500}.nav-links[data-astro-cid-37fxchfa] a[data-astro-cid-37fxchfa]:hover{color:#06c}main[data-astro-cid-37fxchfa]{max-width:1200px;margin:0 auto;padding:2rem;min-height:calc(100vh - 160px)}footer[data-astro-cid-37fxchfa]{background:#f8f9fa;border-top:1px solid #e9ecef;padding:2rem 0;text-align:center;color:#666}footer[data-astro-cid-37fxchfa] a[data-astro-cid-37fxchfa]{color:#06c}
.guide-header[data-astro-cid-oolc5s6i]{margin-bottom:2rem;padding-bottom:2rem;border-bottom:1px solid #e9ecef}.breadcrumb[data-astro-cid-oolc5s6i]{color:#666;font-size:.9rem;margin-bottom:1rem}.breadcrumb[data-astro-cid-oolc5s6i] a[data-astro-cid-oolc5s6i]{color:#06c;text-decoration:none}.breadcrumb[data-astro-cid-oolc5s6i] a[data-astro-cid-oolc5s6i]:hover{text-decoration:underline}.guide-header[data-astro-cid-oolc5s6i] h1[data-astro-cid-oolc5s6i]{color:#333;font-size:2rem;margin-bottom:1rem}.description[data-astro-cid-oolc5s6i]{color:#666;font-size:1.1rem;line-height:1.6;margin-bottom:1.5rem}.metadata[data-astro-cid-oolc5s6i]{display:flex;gap:1rem;flex-wrap:wrap}.phase-badge[data-astro-cid-oolc5s6i]{display:inline-block;padding:.25rem .5rem;border-radius:3px;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em}.phase-plan[data-astro-cid-oolc5s6i]{background:#e3f2fd;color:#1565c0}.phase-build[data-astro-cid-oolc5s6i]{background:#f3e5f5;color:#7b1fa2}.phase-deploy[data-astro-cid-oolc5s6i]{background:#e8f5e8;color:#2e7d32}.phase-support[data-astro-cid-oolc5s6i]{background:#fff3e0;color:#f57c00}.category-badge[data-astro-cid-oolc5s6i]{background:#f5f5f5;color:#666;padding:.25rem .5rem;border-radius:3px;font-size:.75rem}.guide-content[data-astro-cid-oolc5s6i]{max-width:none;line-height:1.7}.guide-content[data-astro-cid-oolc5s6i] h2{color:#333;font-size:1.5rem;margin:2rem 0 1rem;padding-bottom:.5rem;border-bottom:1px solid #e9ecef}.guide-content[data-astro-cid-oolc5s6i] h3{color:#333;font-size:1.25rem;margin:1.5rem 0 .75rem}.guide-content[data-astro-cid-oolc5s6i] p{margin-bottom:1rem;color:#444}.guide-content[data-astro-cid-oolc5s6i] code{background:#f8f9fa;padding:.125rem .25rem;border-radius:3px;font-size:.875rem}.guide-content[data-astro-cid-oolc5s6i] pre{background:#f8f9fa;border:1px solid #e9ecef;border-radius:4px;padding:1rem;overflow-x:auto;margin:1rem 0}.guide-content[data-astro-cid-oolc5s6i] ul,.guide-content[data-astro-cid-oolc5s6i] ol{padding-left:2rem;margin-bottom:1rem}.guide-content[data-astro-cid-oolc5s6i] li{margin-bottom:.5rem}.guide-content[data-astro-cid-oolc5s6i] blockquote{border-left:4px solid #0066cc;margin:1rem 0;padding:.5rem 1rem;background:#f8f9fa;color:#666}.guide-content[data-astro-cid-oolc5s6i] table{width:100%;border-collapse:collapse;margin:1rem 0}.guide-content[data-astro-cid-oolc5s6i] th,.guide-content[data-astro-cid-oolc5s6i] td{border:1px solid #e9ecef;padding:.75rem;text-align:left}.guide-content[data-astro-cid-oolc5s6i] th{background:#f8f9fa;font-weight:600}
</style></head> <body data-astro-cid-37fxchfa> <nav data-astro-cid-37fxchfa> <div class="nav-container" data-astro-cid-37fxchfa> <a href="/" class="logo" data-astro-cid-37fxchfa>Amp Examples & Guides</a> <div class="nav-links" data-astro-cid-37fxchfa> <a href="/guides" data-astro-cid-37fxchfa>Guides</a> <a href="/examples" data-astro-cid-37fxchfa>Examples</a> </div> </div> </nav> <main data-astro-cid-37fxchfa>  <div class="guide-header" data-astro-cid-oolc5s6i> <nav class="breadcrumb" data-astro-cid-oolc5s6i> <a href="/" data-astro-cid-oolc5s6i>Home</a> / <a href="/guides" data-astro-cid-oolc5s6i>Guides</a> /  </nav> <h1 data-astro-cid-oolc5s6i></h1> <p class="description" data-astro-cid-oolc5s6i></p> <div class="metadata" data-astro-cid-oolc5s6i>   </div> </div> <div class="guide-content" data-astro-cid-oolc5s6i> <h1 id="migration-progress-systemdatasqlclient-to-microsoftdatasqlclient">Migration Progress: System.Data.SqlClient to Microsoft.Data.SqlClient</h1>
<h2 id="overview">Overview</h2>
<p><strong>Purpose</strong>: Migrate from System.Data.SqlClient to Microsoft.Data.SqlClient across 15 bank application projects<br>
<strong>Start Date</strong>: July 24, 2025<br>
<strong>Status</strong>: Oracle Review Complete - Critical Blockers Identified &#x26; Resolved in Updated Plan</p>
<h2 id="pre-migration-status">Pre-Migration Status</h2>
<h3 id="build-status-before-migration">Build Status (Before Migration)</h3>
<ul>
<li><strong>Status</strong>: Not yet executed</li>
<li><strong>Target</strong>: Verify all 15 projects build successfully</li>
<li><strong>Command</strong>: <code>dotnet msbuild AcmeBankApp.sln /p:Configuration=Debug</code></li>
</ul>
<h3 id="test-status-before-migration">Test Status (Before Migration)</h3>
<ul>
<li><strong>Status</strong>: Not yet executed</li>
<li><strong>Target</strong>: Establish baseline test results</li>
<li><strong>Command</strong>: <code>vstest.console.exe AcmeBankApp.Tests\bin\Debug\AcmeBankApp.Tests.dll</code></li>
</ul>
<h2 id="migration-analysis-completed">Migration Analysis Completed</h2>
<h3 id="projects-analyzed-15-total">Projects Analyzed: 15 total</h3>
<ul>
<li>✅ bank-app-1 through bank-app-15</li>
<li>✅ Consistent .NET Framework 4.8 structure</li>
<li>✅ Identified 4 files per project requiring changes (60 total files)</li>
</ul>
<h3 id="current-dependencies-identified">Current Dependencies Identified</h3>
<ul>
<li>✅ System.Data.SqlClient 4.6.0 (to be replaced)</li>
<li>✅ EntityFramework 6.2.0 (compatibility verified)</li>
<li>✅ .NET Framework 4.8 (supported)</li>
</ul>
<h3 id="files-requiring-changes-per-project">Files Requiring Changes per Project</h3>
<ol>
<li>✅ <code>AcmeBankApp.Data/packages.config</code></li>
<li>✅ <code>AcmeBankApp.Web/packages.config</code></li>
<li>✅ <code>AcmeBankApp.Data/AcmeBankApp.Data.csproj</code></li>
<li>✅ <code>AcmeBankApp.Data/DataHelper.cs</code></li>
</ol>
<h2 id="specification-planning">Specification Planning</h2>
<h3 id="documentation-created">Documentation Created</h3>
<ul>
<li>✅ <strong>sqldata-migration.md</strong>: Comprehensive migration plan (UPDATED post-Oracle review)</li>
<li>✅ <strong>progress.md</strong>: This progress tracking document (UPDATED with Oracle findings)</li>
</ul>
<h3 id="key-planning-elements">Key Planning Elements</h3>
<ul>
<li>✅ Risk assessment completed and REVISED with critical blockers</li>
<li>✅ Quality assurance plan enhanced with performance baselines</li>
<li>✅ Rollback strategy documented with package backup procedures</li>
<li>✅ Success criteria expanded with security and performance validation</li>
</ul>
<h2 id="git-strategy">Git Strategy</h2>
<h3 id="branch-planning">Branch Planning</h3>
<ul>
<li><strong>Branch Name</strong>: <code>feature/migrate-to-microsoft-data-sqlclient</code></li>
<li><strong>Commit Strategy</strong>: One commit per project + verification commit</li>
<li><strong>PR Strategy</strong>: Single PR with comprehensive build verification</li>
</ul>
<h2 id="issues-encountered">Issues Encountered</h2>
<h3 id="critical-issues-identified-oracle-review">CRITICAL ISSUES IDENTIFIED (Oracle Review)</h3>
<h4 id="-blocker-1-entity-framework-620-incompatibility">🚨 BLOCKER 1: Entity Framework 6.2.0 Incompatibility</h4>
<ul>
<li><strong>Issue</strong>: EF 6.2.0 does NOT support Microsoft.Data.SqlClient provider services</li>
<li><strong>Impact</strong>: EF will silently continue using System.Data.SqlClient from framework</li>
<li><strong>Resolution</strong>: Must upgrade to Entity Framework 6.4.4 + Microsoft.Data.SqlClient.EntityFramework</li>
<li><strong>Status</strong>: BLOCKING - Requires additional phase before migration</li>
</ul>
<h4 id="-blocker-2-breaking-connection-string-defaults">🚨 BLOCKER 2: Breaking Connection String Defaults</h4>
<ul>
<li><strong>Issue</strong>: Microsoft.Data.SqlClient 5.x defaults Encrypt=true (was false in System.Data.SqlClient)</li>
<li><strong>Impact</strong>: LocalDB connections will fail without TLS certificates</li>
<li><strong>Resolution</strong>: Add Encrypt=false and TrustServerCertificate=true to all connection strings</li>
<li><strong>Status</strong>: BLOCKING - Must update all connection strings</li>
</ul>
<h4 id="-blocker-3-native-sni-dependencies">🚨 BLOCKER 3: Native SNI Dependencies</h4>
<ul>
<li><strong>Issue</strong>: Microsoft.Data.SqlClient requires platform-specific SNI.dll native libraries</li>
<li><strong>Impact</strong>: Build agents and test runners may fail without proper deployment</li>
<li><strong>Resolution</strong>: Ensure x64 platform builds and test execution</li>
<li><strong>Status</strong>: BLOCKING - Requires build configuration changes</li>
</ul>
<h3 id="revised-risk-assessment">Revised Risk Assessment</h3>
<ul>
<li><strong>High Risk</strong>: Entity Framework compatibility, connection string encryption, native dependencies</li>
<li><strong>Medium Risk</strong>: Performance impact, TLS version compatibility, connection pooling changes</li>
<li><strong>Low Risk</strong>: Namespace changes (after compatibility issues resolved)</li>
</ul>
<h2 id="revised-migration-steps-post-oracle-review">REVISED Migration Steps (Post Oracle Review)</h2>
<h3 id="phase-0-critical-compatibility-resolution-new---required">Phase 0: Critical Compatibility Resolution (NEW - REQUIRED)</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled> Entity Framework upgrade: 6.2.0 → 6.4.4 across all projects</li>
<li class="task-list-item"><input type="checkbox" disabled> Install Microsoft.Data.SqlClient.EntityFramework provider packages</li>
<li class="task-list-item"><input type="checkbox" disabled> Create DbConfiguration classes for provider registration</li>
<li class="task-list-item"><input type="checkbox" disabled> Update connection strings with encryption parameters (Encrypt=false)</li>
<li class="task-list-item"><input type="checkbox" disabled> Canary testing on bank-app-1 before proceeding</li>
</ul>
<h3 id="phase-1-enhanced-pre-migration-validation">Phase 1: Enhanced Pre-Migration Validation</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled> Capture ADO.NET performance baseline counters</li>
<li class="task-list-item"><input type="checkbox" disabled> Build verification with x64 platform configuration</li>
<li class="task-list-item"><input type="checkbox" disabled> Add TLS connection health probe integration tests</li>
<li class="task-list-item"><input type="checkbox" disabled> Verify SNI.dll native library deployment on build agents</li>
</ul>
<h3 id="phase-2-comprehensive-package-migration">Phase 2: Comprehensive Package Migration</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled> Entity Framework upgrade validation (if not done in Phase 0)</li>
<li class="task-list-item"><input type="checkbox" disabled> Install Microsoft.Data.SqlClient + EntityFramework extension</li>
<li class="task-list-item"><input type="checkbox" disabled> Remove System.Data.SqlClient packages cleanly</li>
<li class="task-list-item"><input type="checkbox" disabled> Update .csproj references with AutoGenerateBindingRedirects</li>
</ul>
<h3 id="phase-3-enhanced-code-migration">Phase 3: Enhanced Code Migration</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled> Update DbConfiguration and Web.config provider settings</li>
<li class="task-list-item"><input type="checkbox" disabled> Update using statements (84+ files including new config files)</li>
<li class="task-list-item"><input type="checkbox" disabled> Update all connection strings with encryption parameters</li>
<li class="task-list-item"><input type="checkbox" disabled> Verify assembly redirects for cryptography dependencies</li>
</ul>
<h3 id="phase-4-comprehensive-post-migration-validation">Phase 4: Comprehensive Post-Migration Validation</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled> Build verification with strict error/warning checking</li>
<li class="task-list-item"><input type="checkbox" disabled> TLS handshake and connection pooling validation</li>
<li class="task-list-item"><input type="checkbox" disabled> Performance counter comparison vs baseline (±5% tolerance)</li>
<li class="task-list-item"><input type="checkbox" disabled> CodeQL/SonarQube security scanning for SQL injection</li>
</ul>
<h2 id="next-steps">Next Steps</h2>
<h3 id="immediate-actions">Immediate Actions</h3>
<ol>
<li>✅ <strong>Oracle Review</strong>: Expert review completed with critical findings</li>
<li>✅ <strong>Plan Refinement</strong>: Specification updated based on Oracle feedback</li>
<li>⏳ <strong>Execution Approval</strong>: Confirm updated plan before beginning migration</li>
<li>🆕 <strong>Risk Mitigation</strong>: Address EF 6.4.4 upgrade and connection string security</li>
</ol>
<h3 id="execution-readiness">Execution Readiness</h3>
<ul>
<li>✅ Comprehensive plan created and REVISED</li>
<li>✅ All files identified and mapped (84+ files vs original 60)</li>
<li>✅ Commands documented with platform-specific requirements</li>
<li>✅ Oracle validation complete with critical blockers addressed</li>
<li>⏳ <strong>Ready for execution approval</strong> with enhanced risk mitigation</li>
</ul>
<h2 id="summary">Summary</h2>
<h3 id="what-was-completed">What Was Completed</h3>
<ul>
<li>✅ Comprehensive analysis of 15 bank application projects</li>
<li>✅ Identification of all System.Data.SqlClient usage patterns</li>
<li>✅ Detailed migration specification with risk assessment (REVISED)</li>
<li>✅ Quality assurance and rollback planning (ENHANCED)</li>
<li>✅ Complete documentation of required changes (UPDATED)</li>
<li>✅ <strong>Oracle expert review identifying 3 critical blockers</strong></li>
<li>✅ <strong>Updated migration plan addressing all Oracle findings</strong></li>
</ul>
<h3 id="what-changed-revised-after-oracle-review">What Changed (REVISED After Oracle Review)</h3>
<ul>
<li><strong>Files Analyzed</strong>: 84+ files across 15 projects (increased from 60 due to EF upgrade)</li>
<li><strong>Dependencies Mapped</strong>:
<ul>
<li>EntityFramework 6.2.0 → 6.4.4 (CRITICAL upgrade required)</li>
<li>System.Data.SqlClient 4.6.0 → Microsoft.Data.SqlClient 5.1.1</li>
<li>Added: Microsoft.Data.SqlClient.EntityFramework provider</li>
</ul>
</li>
<li><strong>Migration Strategy</strong>: REVISED from simple drop-in to comprehensive upgrade with EF compatibility resolution</li>
</ul>
<h3 id="why-these-changes">Why These Changes</h3>
<ul>
<li><strong>CRITICAL COMPATIBILITY</strong>: EF 6.2.0 does not support Microsoft.Data.SqlClient</li>
<li><strong>Security Requirements</strong>: New encryption defaults require explicit connection string updates</li>
<li><strong>Platform Compatibility</strong>: Native SNI dependencies require x64 build configuration</li>
<li><strong>Future-Proofing</strong>: Prepares codebase for future .NET migrations with proper provider support</li>
</ul>
<h3 id="current-state">Current State</h3>
<p><strong>Oracle review completed - CRITICAL BLOCKERS IDENTIFIED</strong> - Specification updated with mandatory EF upgrade path, connection string security updates, and enhanced validation requirements. Migration complexity increased from 2.5 to 6 hours due to EF compatibility requirements.</p> </div>  </main> <footer data-astro-cid-37fxchfa> <p data-astro-cid-37fxchfa>© 2024 Sourcegraph. Supplemental to the <a href="https://ampcode.com/manual" data-astro-cid-37fxchfa>Amp Manual</a>.</p> </footer> </body></html> 